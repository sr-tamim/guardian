monitoring:
  lookback_duration: "1h"
  check_interval: "30s"
  enable_real_time: true
  log_buffer_size: 1000

blocking:
  failure_threshold: 5
  block_duration: "20h"
  max_concurrent_blocks: 1000
  whitelisted_ips:
    - "127.0.0.1"
    - "::1"
    - "192.168.1.0/24"
  auto_unblock: true
  rule_name_template: "Guardian - {timestamp} - {ip}"

logging:
  level: "info"
  format: "text"
  output: "stdout"
  enable_file: true
  # Platform-aware path will be used if commented out
  file_path: "C:\\ProgramData\\Guardian\\logs\\guardian.log"
  # Enhanced logging configuration for robust behavior
  enable_contextual: true       # Include function, file, module context
  log_event_lookups: true       # Log every event lookup with IP counts
  log_firewall_actions: true    # Log when IPs are blocked/unblocked with rule details
  log_attack_attempts: true     # Log detected attack attempts with details
  log_monitoring_events: true   # Log monitoring start/stop events
  log_cleanup_events: true      # Log cleanup operations with counts

storage:
  type: "sqlite"
  # Platform-aware path will be used if commented out
  # file_path: "C:\\ProgramData\\Guardian\\data\\guardian.db"

services:
  - name: "RDP"
    log_path: "Security"  # Windows Event Log
    log_pattern: "4625"   # Failed logon event ID
    custom_threshold: 0
    enabled: true
